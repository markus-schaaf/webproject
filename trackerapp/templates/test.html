<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalorien Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #2e2f2b;
            color: #d1d1c7;
            margin: 0;
            padding: 20px;
        }
        .center {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            height: 100vh;
        }
        header {
            position: sticky;
            top: 0;
            background-color: #1f2921;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 20px;
            display: none; /* Unsichtbar, bis Kalorienbedarf berechnet wurde */
        }
        header h1 {
            margin: 0;
            color: #c7e6c2;
        }
        #calorie-info span:first-child {
            font-size: 1rem; /* Standardgröße */
            color: #d1d1c7; /* Helles Grau */
         }

        #remaining-calories {
            font-family: 'Courier New', monospace; /* Schriftart für Zahlen */
            font-size: 10rem; /* Größerer Text */
            font-weight: bold;
            color: #c7e6c2; /* Helles Grün */
         }

        form {
            margin-bottom: 20px;
            background-color: #1f2921;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        form input, form button {
            padding: 10px;
            margin: 5px 0;
            border: none;
            border-radius: 4px;
        }
        form input {
            width: calc(100% - 22px);
            background-color: #40433f;
            color: #d1d1c7;
        }
        form button {
            background-color: #3c5941;
            color: #d1d1c7;
            cursor: pointer;
        }
        form button:hover {
            background-color: #4a6b4f;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: #1f2921;
            border-radius: 8px;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border: 1px solid #40433f;
        }
        th {
            background-color: #3c5941;
            color: #c7e6c2;
        }
        td {
            color: #d1d1c7;
        }
        tfoot td {
            font-weight: bold;
            color: #c7e6c2;
        }
        #macro-info {
            display: flex;
            justify-content: center; /* Zentriert die Inhalte horizontal */
            gap: 20px; /* Abstand zwischen den Elementen */
            margin-top: 10px;
            color: #c7e6c2;
            font-size: 1rem;
        }

        #macro-info span {
            font-weight: bold;
        }
        
        .pie-chart {
        width: 200px;
        height: 200px;
        border-radius: 50%;
        background: conic-gradient(
            #ff9999 0% 20%,
            #99ccff 20% 50%, 
            #99ff99 50% 100% 
        );
        margin: 20px auto;
        }

        .legend {
        display: flex; 
        justify-content: center;
        margin-top: 20px;
        gap: 15px;
        }

        .legend-item {
        display: flex;
        align-items: center;
        }

        .legend-item span {
        display: inline-block;
        width: 15px;
        height: 15px;
        margin-right: 5px; 
        }

        .legend .red { background: #ff9999; }
        .legend .blue { background: #99ccff; }
        .legend .green { background: #99ff99; }
    </style>
</head>
<body>
    <!-- Eingabeformular für Kalorienbedarf -->
    <div id="calorie-form" class="center">
        <form id="user-form">
            <h2>Berechnen Sie Ihren täglichen Kalorienbedarf</h2>
            <label for="weight">Wie schwer sind Sie? (in kg)</label>
            <input type="number" id="weight" placeholder="z. B. 70" required>
            <label for="age">Wie alt sind Sie? (in Jahren)</label>
            <input type="number" id="age" placeholder="z. B. 25" required>
            <label for="height">Wie groß sind Sie? (in cm)</label>
            <input type="number" id="height" placeholder="z. B. 175" required>
            <button type="submit">Kalorienbedarf berechnen</button>
        </form>
    </div>

    <!-- Hauptansicht -->
    <header>
        <h1>Kalorien Tracker</h1>
        <p id="calorie-info">
            <span>Ihr täglicher Kalorienbedarf:</span>
            <span id="remaining-calories" style="font-family: 'Courier New', monospace; font-size: 1.5rem;">-</span> kcal
        </p>
        <p id="macro-info">
            <span>Kohlenhydrate: <span id="carb-grams">-</span> g (50%)</span><br>
            <span>Proteine: <span id="protein-grams">-</span> g (20%)</span><br>
            <span>Fette: <span id="fat-grams">-</span> g (30%)</span>
        </p>   

        <div class="pie-chart"></div>
            <div class="legend">
                <p><span class="red"></span> 20%</p>
                <p><span class="blue"></span> 30%</p>
                <p><span class="green"></span> 50%</p>
            </div>
    </header>
    <main style="display: none;">
        <section>
            <form id="food-form">
                <label for="food-name">Essen:</label>
                <input type="text" id="food-name" placeholder="z. B. Apfel" required>
        
                <label for="calories">Kalorien:</label>
                <input type="number" id="calories" placeholder="z. B. 95" required>
        
                <label for="carbs">Kohlenhydrate (in g):</label>
                <input type="number" id="carbs" placeholder="z. B. 25" required>
        
                <label for="proteins">Proteine (in g):</label>
                <input type="number" id="proteins" placeholder="z. B. 1" required>
        
                <label for="fats">Fette (in g):</label>
                <input type="number" id="fats" placeholder="z. B. 0.5" required>
        
                <button type="submit">Hinzufügen</button>
            </form>
        </section>        
        <section>
            <h2>Deine tägliche Kalorienliste</h2>
            <table>
                <thead>
                    <tr>
                        <th>Essen</th>
                        <th>Kalorien</th>
                    </tr>
                </thead>
                <tbody id="food-list">
                    <!-- Dynamisch eingefügte Daten erscheinen hier -->
                </tbody>
                <tfoot>
                    <tr>
                        <td>Gesamt konsumiert:</td>
                        <td id="total-consumed">0</td>
                    </tr>
                </tfoot>
            </table>
        </section>
    </main>

    <script>
        
        let dailyCalories = 0; // Täglicher Kalorienbedarf
        let consumedCalories = 0; // Kalorien bereits konsumiert

        const userForm = document.getElementById('user-form');
        const calorieForm = document.getElementById('calorie-form');
        const calorieInfo = document.getElementById('calorie-info');
        const remainingCalories = document.getElementById('remaining-calories');
        const foodForm = document.getElementById('food-form');
        const foodList = document.getElementById('food-list');
        const totalConsumed = document.getElementById('total-consumed');
        const mainContent = document.querySelector('main');
        const header = document.querySelector('header');

        // Benutzerformular zur Berechnung des Kalorienbedarfs
        userForm.addEventListener('submit', function (event) {
            event.preventDefault();

            const weight = parseFloat(document.getElementById('weight').value);
            const age = parseInt(document.getElementById('age').value, 10);
            const height = parseInt(document.getElementById('height').value, 10);

            if (weight && age && height) {
                // Kalorienbedarf berechnen (Mifflin-St Jeor Formel)
                dailyCalories = Math.round(10 * weight + 6.25 * height - 5 * age + 5); // Männer
                remainingCalories.textContent = dailyCalories;

                // Makronährstoffe berechnen
                const carbCalories = dailyCalories * 0.50; // 50% der Kalorien
                const proteinCalories = dailyCalories * 0.20; // 20% der Kalorien
                const fatCalories = dailyCalories * 0.30; // 30% der Kalorien

                // In Gramm umrechnen
                const carbGrams = Math.round(carbCalories / 4); // 1 g Kohlenhydrate = 4 kcal
                const proteinGrams = Math.round(proteinCalories / 4); // 1 g Proteine = 4 kcal
                const fatGrams = Math.round(fatCalories / 9); // 1 g Fett = 9 kcal

                // Werte anzeigen
                document.getElementById('carb-grams').textContent = carbGrams;
                document.getElementById('protein-grams').textContent = proteinGrams;
                document.getElementById('fat-grams').textContent = fatGrams;

                // Formular ausblenden, Hauptansicht zeigen
                calorieForm.style.display = 'none';
                header.style.display = 'block';
                mainContent.style.display = 'block';
            } else {
                alert("Bitte geben Sie gültige Werte ein.");
            }
        });


        // Kalorienverbrauchsformular
        foodForm.addEventListener('submit', function (event) {
        event.preventDefault();

        // Eingabedaten aus dem Formular auslesen
        const foodName = document.getElementById('food-name').value.trim();
        const calories = parseInt(document.getElementById('calories').value.trim(), 10);
        const carbs = parseInt(document.getElementById('carbs').value.trim(), 10);
        const proteins = parseInt(document.getElementById('proteins').value.trim(), 10);
        const fats = parseInt(document.getElementById('fats').value.trim(), 10);

        if (foodName && calories && carbs && proteins && fats) {
            // Eine neue Zeile für das Lebensmittel hinzufügen
            const row = document.createElement('tr');
            row.innerHTML = `<td>${foodName}</td><td>${calories}</td>`;
            foodList.appendChild(row);

            // Kalorien und Makronährstoffe vom Gesamtbedarf abziehen
            consumedCalories += calories;
            dailyCalories -= calories;
            remainingCalories.textContent = dailyCalories >= 0 ? dailyCalories : 0;

            // Makronährstoffe abziehen
            const remainingCarbs = document.getElementById('carb-grams');
            const remainingProteins = document.getElementById('protein-grams');
            const remainingFats = document.getElementById('fat-grams');

            const updatedCarbs = parseInt(remainingCarbs.textContent) - carbs;
            const updatedProteins = parseInt(remainingProteins.textContent) - proteins;
            const updatedFats = parseInt(remainingFats.textContent) - fats;

            // Werte aktualisieren
            remainingCarbs.textContent = updatedCarbs >= 0 ? updatedCarbs : 0;
            remainingProteins.textContent = updatedProteins >= 0 ? updatedProteins : 0;
            remainingFats.textContent = updatedFats >= 0 ? updatedFats : 0;

            // Gesamtverbrauchte Kalorien aktualisieren
            totalConsumed.textContent = consumedCalories;

            // Formular zurücksetzen
            foodForm.reset();
        } else {
            alert("Bitte füllen Sie alle Felder aus.");
        }
    });

    </script>
</body>
</html>
